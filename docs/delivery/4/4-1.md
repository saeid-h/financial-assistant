# Task 4-1: Create Category Model and Hierarchy

[Back to task list](./tasks.md)

## Description

Build the Category model to interact with the categories table and support hierarchical category structures (parent-child-grandchild relationships).

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-10-19 22:00:00 | Created | N/A | Proposed | Task created | Saeed |
| 2025-10-19 22:00:00 | Approved | Proposed | Agreed | Essential for categorization | Saeed |
| 2025-10-19 22:10:00 | Started | Agreed | InProgress | Creating Category model | Saeed |
| 2025-10-19 22:15:00 | Completed | InProgress | Review | Category model fully implemented | Saeed |
| 2025-10-19 22:16:00 | Approved | Review | Done | Model working with existing categories | Saeed |

## Requirements

1. Category model with database operations
2. Support for 3-level hierarchy (parent → child → grandchild)
3. get_all(), get_by_id(), get_by_type() methods
4. get_hierarchy() to build tree structure
5. get_full_path() for category breadcrumbs
6. CRUD operations (create, update, delete)
7. Use existing categories table from init_db.py

## Implementation

**File**: `src/models/category.py`

**Key Methods:**
- `get_all()`: Returns all categories with parent names
- `get_by_id()`: Get single category
- `get_by_type()`: Filter by income/expense
- `get_hierarchy()`: Build tree structure for display
- `get_full_path()`: Returns "Parent → Child → Grandchild"
- `create()`: Add new category with validation
- `update()`: Modify category
- `delete()`: Remove category

**Features:**
- Supports 3-level hierarchy
- Validates category type (income/expense)
- Validates level (1-3)
- Returns parent information for easy display

## Verification

- [x] Category model created
- [x] All CRUD methods working
- [x] Hierarchy building works
- [x] Full path generation works
- [x] Integrates with existing database
- [x] 30 seeded categories accessible

## Files Modified

**New:**
- `src/models/category.py` - Complete Category model

## Notes

Database already has 30 categories seeded from init_db.py:
- 5 income categories
- 25 expense categories
- 3-level hierarchy functional


