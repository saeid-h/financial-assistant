# Task 2-1: Create Account Management UI and API

[Back to task list](./tasks.md)

## Description

Build the account management functionality that allows users to create, list, and select bank/credit card accounts. This is a prerequisite for CSV import as users need to associate imported transactions with specific accounts.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-10-19 18:35:00 | Created | N/A | Agreed | Task approved for implementation | Saeed |
| 2025-10-19 18:35:00 | Started | Agreed | InProgress | Beginning implementation | Saeed |
| 2025-10-19 18:45:00 | Completed | InProgress | Done | All tests passing (44/44), accounts page working | Saeed |

## Requirements

1. Database model for accounts (already exists from PBI 1)
2. API endpoints for account operations:
   - POST `/api/accounts` - Create new account
   - GET `/api/accounts` - List all accounts
   - GET `/api/accounts/<id>` - Get single account
3. Web UI for account management:
   - `/accounts` page - List accounts
   - Add account form (modal or separate page)
4. Form validation (name required, type required)
5. Success/error messages

## Implementation Plan

### 1. Create Account Model/Service (`src/models/account.py`)
```python
class Account:
    @staticmethod
    def create(name, type, institution)
    @staticmethod
    def get_all()
    @staticmethod
    def get_by_id(id)
```

### 2. Create Account Routes (`src/routes/accounts.py`)
- POST `/api/accounts` - Create account
- GET `/api/accounts` - List accounts
- GET `/api/accounts/<id>` - Get account

### 3. Create Account UI (`src/templates/accounts.html`)
- List of accounts in table/cards
- "Add Account" button
- Add account modal with form
- Display account type and institution

### 4. Add Navigation Link
- Update `index.html` with "Accounts" link
- Update template base (if needed)

## Test Plan

**Success Criteria:**
- Can create accounts via API
- Can list accounts via API
- Accounts page displays all accounts
- Form validation works
- Success messages display correctly

**Unit Tests:**
- test_create_account()
- test_get_all_accounts()
- test_get_account_by_id()
- test_account_validation()

**Integration Tests:**
- test_accounts_api_endpoint()
- test_accounts_page_loads()
- test_create_account_flow()

## Verification

- [x] Account model created
- [x] API endpoints working (5 routes)
- [x] Accounts page accessible at /accounts
- [x] Can create accounts via UI
- [x] Tests passing (31 account tests, 44 total)

## Files Modified

**Created:**
- `src/models/account.py`
- `src/routes/accounts.py`
- `src/templates/accounts.html`
- `src/templates/components/account_form.html` (if using modals)
- `src/static/js/accounts.js` (if needed for interactivity)
- `tests/unit/test_account_model.py`
- `tests/integration/test_accounts.py`

**Updated:**
- `src/app.py` (register account routes)
- `src/templates/index.html` (add navigation link)

## Notes

- Keep UI simple and functional (matches existing style)
- Use existing CSS from style.css
- Account types: checking, savings, credit
- Institution is optional field

